---
import LandingLayout from '../layouts/LandingLayout.astro';
import Hero from '../components/landing/delivery-process/Hero.astro';
import Metrics from '../components/landing/delivery-process/Metrics.astro';
import CodeExamples from '../components/landing/delivery-process/CodeExamples.astro';
import Pillars from '../components/landing/delivery-process/Pillars.astro';
import McpCallout from '../components/landing/delivery-process/McpCallout.astro';
import FooterCta from '../components/landing/delivery-process/FooterCta.astro';

const base = import.meta.env.BASE_URL;
---

<LandingLayout
	title="@libar-dev/delivery-process â€” Stop Prompting. Start Context Engineering."
	description="Turn your static codebase into a deterministic, queryable read-model. Extract patterns from TypeScript and Gherkin, enforce delivery workflow via FSM, and feed AI agents exactly the context they need."
>
	<nav class="landing-nav">
		<div class="landing-nav__left">
			<a href={base} class="landing-nav__brand">@libar-dev</a>
			<span class="landing-nav__version">v1.0.0-pre</span>
		</div>

		<button class="landing-nav__hamburger" id="nav-hamburger" aria-label="Toggle menu">
			<span></span><span></span><span></span>
		</button>

		<ul class="landing-nav__links" id="nav-links">
			<li><a href="#metrics">Scale</a></li>
			<li><a href="#code">Code</a></li>
			<li><a href="#pillars">Features</a></li>
			<li><a href={`${base}delivery-process/`}>Docs</a></li>
			<li><a href="https://github.com/libar-dev">GitHub</a></li>
			<li>
				<button class="landing-nav__theme-toggle" id="theme-toggle" aria-label="Toggle theme">
					<svg class="icon-sun" viewBox="0 0 24 24">
						<circle cx="12" cy="12" r="5"></circle>
						<line x1="12" y1="1" x2="12" y2="3"></line>
						<line x1="12" y1="21" x2="12" y2="23"></line>
						<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
						<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
						<line x1="1" y1="12" x2="3" y2="12"></line>
						<line x1="21" y1="12" x2="23" y2="12"></line>
						<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
						<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
					</svg>
					<svg class="icon-moon" viewBox="0 0 24 24">
						<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
					</svg>
				</button>
			</li>
		</ul>
	</nav>

	<Hero base={base} />
	<Metrics />
	<CodeExamples />
	<Pillars base={base} />
	<McpCallout />
	<FooterCta base={base} />

	<footer class="landing-footer">
		<span>MIT License &copy; {new Date().getFullYear()} @libar-dev</span>
		<div class="landing-footer__links">
			<a href="https://www.npmjs.com/package/@libar-dev/delivery-process">npm</a>
			<a href="https://github.com/libar-dev/delivery-process">GitHub</a>
			<a href={`${base}delivery-process/`}>Docs</a>
		</div>
	</footer>
</LandingLayout>

<script is:inline>
	// Theme toggle
	document.getElementById('theme-toggle').addEventListener('click', function () {
		const html = document.documentElement;
		const current = html.getAttribute('data-theme');
		const next = current === 'dark' ? 'light' : 'dark';
		html.setAttribute('data-theme', next);
		localStorage.setItem('starlight-theme', next);
	});

	// Hamburger nav toggle
	document.getElementById('nav-hamburger').addEventListener('click', function () {
		document.getElementById('nav-links').classList.toggle('open');
	});

	// Scroll reveal
	(function () {
		const reveals = document.querySelectorAll('.reveal');
		if (!reveals.length) return;
		const io = new IntersectionObserver(
			function (entries) {
				entries.forEach(function (entry) {
					if (entry.isIntersecting) {
						entry.target.classList.add('visible');
						io.unobserve(entry.target);
					}
				});
			},
			{ threshold: 0.1 }
		);
		reveals.forEach(function (el) {
			io.observe(el);
		});
	})();
</script>
